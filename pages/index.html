<!DOCTYPE html>
<!--
Template Name: Skaxis
Author: <a href="https://www.os-templates.com/">OS Templates</a>
Author URI: https://www.os-templates.com/
Licence: Free to use under our free template licence terms
Licence URI: https://www.os-templates.com/template-terms
-->
<html lang="">
<head>
<title>Beribu</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="../layout/styles/layout.css" rel="stylesheet" type="text/css" media="all">
</head>
<body id="top"> 

<div class="bgded overlay" style="background-image:url('https://plus.unsplash.com/premium_photo-1683865776032-07bf70b0add1?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D');"> 
  <div class="wrapper row1">
    <header id="header" class="hoc clear"> 
      <div id="logo" class="fl_left">
        <h1><a href="../index.html">Beribu</a></h1>
      </div>
      <nav id="mainav" class="fl_right">
        <ul class="clear" id="logauth_button_nav">
          <li><a href="../">Home</a></li>
          <li id="li-atas-opini"><a href="../pages/index.html?q=kategori-opini" >Opini</a></li>
          <li id="li-atas-hukum"><a href="../pages/index.html?q=kategori-hukum" >Hukum</a></li>
          <li id="li-atas-sastra"><a href="../pages/index.html?q=kategori-sastra" >Sastra</a></li>
        </ul>
      </nav>
    </header>
  </div>
</div>

<div class="form-popup" id="myForm">
    <div class="form-container" id="loginSession">
        <h2 style="color: black;">Login</h2>

        <label for="email"><b style="color: black;">Email</b></label>
        <input type="text" placeholder="Enter username" id="usernameLoginAuth" style="color: black;" required>

        <label for="psw"><b style="color: black;">Password</b></label>
        <input type="password" placeholder="Enter Password" id="passwordLoginAuth" style="color: black;" required>

        <button class="btn" onclick="authLogin()">Login</button>
        <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
    </div>
    <div class="form-container" id="logoutSession">

        <h2 style="color: black;">This is suci</h2>

        <button class="btn" onclick="authLogout()">Logout</button>
        <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
    </div>
</div>

<div class="wrapper row3">
  <main class="hoc container clear">
    <div id="newArticleMake">
        <article class="group btmspace-80">
            <h6 class="heading">Hai Suci ada karangan baru kah ?</h6>
            <footer class="nospace"><a href="#" class="btn" onclick="openNewPage()">Buat Artikel Baru <i class="fa fa-pencil"></i> </a></footer>
        </article>

        <hr class="btmspace-80">
    </div>

    <ul class="nospace group overview" id="contentArticle">      
    </ul>
    <div class="clear"></div>
  </main>
</div>
<div class="wrapper row4">
  <footer id="footer" class="hoc clear"> 
    
    <div class="one_quarter first">
      <h6 class="heading">The Gorontalo Institute</h6>
      <ul class="nospace btmspace-30 linklist contact">
Suci Priyanti Kartika Chanda Sari adalah penulis, pengacara, dan peneliti yang fokus pada isu hukum, perempuan, politik, serta kesehatan mental. Saat ini ia menyelesaikan pascasarjana di Universitas Trisakti dan aktif menulis puisi serta berkontribusi dalam proyek hukum dan sosial.
      </ul>
      <ul class="faico clear">
        <li><a class="faicon-facebook" href="#"><i class="fa fa-facebook"></i></a></li>
        <li><a class="faicon-twitter" href="#"><i class="fa fa-twitter"></i></a></li>
        <li><a class="faicon-dribble" href="#"><i class="fa fa-dribbble"></i></a></li>
        <li><a class="faicon-linkedin" href="#"><i class="fa fa-linkedin"></i></a></li>
      </ul>
    </div>
    <div class="one_quarter">
      <h6 class="heading">About</h6>
      <ul class="nospace linklist">
        <li><a href="#">Why I write</a></li>
        <li><a href="#">My Experience</a></li>
        <li><a href="#">My Journey</a></li>
        <li><a href="#">My Goals</a></li>
      </ul>
    </div>
    <div class="one_quarter">
      <h6 class="heading">Resources</h6>
      <ul class="nospace linklist">
        <li><a href="#">Home</a></li>
        <li><a href="#">Curriculum Vittae</a></li>
        <li><a href="#">Activity</a></li>
        <li><a href="#">About</a></li>
      </ul>
    </div>
    <div class="one_quarter">
      <h6 class="heading">Address</h6>
      <ul class="nospace linklist">
        <li><i class="fa fa-instagram"></i> @sucypkcs</li>
        <li><i class="fa fa-phone"></i> +62 822 6021 4643</li>
        <li><i class="fa fa-envelope-o"></i> sucipkcs@gmail.com</li>
      </ul>
    </div>

  </footer>
</div>
<div class="wrapper row5">
  <div id="copyright" class="hoc clear"> 

    <p class="fl_left">Copyright &copy; 2024 - All Rights Reserved - <a href="../">Beribu</a></p>

  </div>
</div>
<a id="backtotop" href="#top"><i class="fa fa-chevron-up"></i></a>
<!-- JAVASCRIPTS -->
<script src="../layout/scripts/jquery.min.js           "></script>
<script src="../layout/scripts/jquery.backtotop.js     "></script>
<script src="../layout/scripts/jquery.mobilemenu.js    "></script>
<script src="../layout/scripts/jquery.flexslider-min.js"></script>
<script src="../layout/scripts/auth.js"></script>
<script>

    function openNewPage() {
        window.open(
        'article_input.html', // URL yang ingin dibuka
        '_blank', // Target jendela baru
        // 'width=1366,height=760,scrollbars=yes,resizable=yes' // Properti jendela
        'width=800,height=600,scrollbars=yes,resizable=yes' // Properti jendela
      );
    }


  function openForm() {
    document.getElementById("myForm").style.display = "block";
  }

  function closeForm() {
    document.getElementById("myForm").style.display = "none";
  }

  function pastikanLogin(){
    let buttonNav = document.getElementById("logauth_button_nav");
    
      if(sessionStorage.getItem("username")){

            document.getElementById("newArticleMake").style.display = "block";
            const auth_delete = document.querySelectorAll('[id*="auth-delete"]');
            auth_delete.forEach(element => {
                element.style.display = 'inline-block';
            });
            document.getElementById("logoutSession").style.display = "block";
            
            document.getElementById("loginSession").style.display = "none";
            const li = document.createElement("li");
            li.setAttribute("id", "loginSessionButton");
            const a_href = document.createElement("a");
            a_href.textContent = "Logout";
            a_href.href = "#";
            a_href.addEventListener('click', (event) => {
                event.preventDefault();
                openForm();
            })

            li.appendChild(a_href);
            buttonNav.appendChild(li);
      }
      else{
        
            document.getElementById("newArticleMake").style.display = "none";

            document.getElementById("loginSession").style.display = "block";

            const auth_delete = document.querySelectorAll('[id*="auth-delete"]');
            auth_delete.forEach(element => {
                element.style.display = 'none';
            });
            document.getElementById("logoutSession").style.display = "none";
            const li = document.createElement("li");
            li.setAttribute("id", "logoutSessionButton");
            const a_href = document.createElement("a");
            a_href.innerHTML = "login";
            a_href.href = "#";
            a_href.addEventListener('click', (event) => {
                event.preventDefault();
                openForm();
            })

            li.appendChild(a_href);
            buttonNav.appendChild(li);
      }
  }

  function fetchDeleteArticle(id,content) {
    // console.log("delete")
    const formdata = new FormData();
    formdata.append("status", "delete_article");
    formdata.append("id_article", id);
    // console.log("id : " + id);
    // console.log("content : " + content);

    const requestOptions = {
      method: "POST",
      body: formdata,
      redirect: "follow"
    };

    fetch("https://alanzulwas.my.id/api/article.php", requestOptions)
    .then((response) => response.text())
    .then((result) => {
      let resultj = JSON.parse(result)

      console.log(resultj)
      // console.log(result)

      alert(resultj['message'])

      content.remove();
    })
    .catch((error) => console.error(error));
  }
</script>
 <script>

  const url_source = "https://alanzulwas.my.id/";

  const requestOptions = {
    method: "GET",
    redirect: "follow"
  };
  
  fetch( url_source + "api/article.php", requestOptions)
    .then((response) => response.text())
    .then((result) => {
        let resultj = JSON.parse(result)

        const content = document.getElementById("contentArticle");
        const params = new URLSearchParams(window.location.search);
        const dbName = params.get('q');
        let kategori = '';

        if (dbName) {
          kategori = dbName.split('-').pop();
        }

        if (kategori === 'opini'){
          document.getElementById('li-atas-opini').setAttribute("class","active")
        }
        if (kategori === 'hukum'){
          document.getElementById('li-atas-hukum').setAttribute("class","active")
        }
        if (kategori === 'sastra'){
          document.getElementById('li-atas-sastra').setAttribute("class","active")
        }



        let count = 0;
        resultj.forEach((json) => {
            

            if(json.kategori === kategori){
              // class one_third
              const one_third = document.createElement("li");
              // let att = document.createAttribute("class");
              // att.value = "one_third";
              one_third.setAttribute("class", "one_third");
              

              //article
              const article = document.createElement("article");
              //article ahref
              const a_href = document.createElement("a");
              a_href.setAttribute("href", "https://suci-id.github.io/beribu/pages/article.html?q=" + json.title.replace(/\s+/g, '_') + "-" + json.id);

              const img = document.createElement("img");
              img.style.width = 300 + "px";
              img.style.height = 175 + "px";
              img.style.objectFit = "contain";
              let cleanPath = json.thumbnail.replace(/\.\.\//g, "");
              img.setAttribute("src", url_source + cleanPath);
              // article h6
              const h6 = document.createElement("h6");
              h6.setAttribute("class", "heading");
              h6.textContent = json.title;
              
              // article ul nospace meta
              const ul = document.createElement("ul");
              ul.setAttribute("class", "nospace meta");
              const li1 = document.createElement("li");
              let i1 = document.createElement("i");
              let i2 = document.createElement("i");
              let a = document.createElement("a");
              let a2 = document.createElement("a");
              
              i1.setAttribute("class", "fa fa-user")
              a.setAttribute("href", "#");
              a.textContent = " admin"; 
              li1.appendChild(i1);
              ul.appendChild(li1);
              ul.appendChild(a);
              a2.setAttribute("id", "auth-delete")
              a2.style.display = 'inline-block';
              a2.style.position = 'relative';
              a2.style.right = '-20%';
              
              a2.textContent = " hapus"; 
              a2.href = "#";
              a2.addEventListener('click', (event) => {
                  event.preventDefault();
                  fetchDeleteArticle(json.id,one_third)
              })
              i2.setAttribute("class", "fa fa-trash")
              a2.innerHTML = a2.innerHTML + " ";
              a2.appendChild(i2);
              ul.appendChild(a2);


              // article p  
              // const p = document.createElement("div");
              // p.innerHTML = json.description.substring(0, 100) + "...";

              // article footer
              const footer = document.createElement("footer");
              footer.setAttribute("class", "nospace")
              const a_footer = document.createElement("a");
              a_footer.setAttribute("class", "btn");
              a_footer.textContent = "Baca selengkapnya";
              a_footer.setAttribute("href", url_source + "pages/article.html?q=" + json.title.replace(/\s+/g, '_') + "-" + json.id);
              footer.appendChild(document.createElement('br'))
              footer.appendChild(a_footer);

              a_href.appendChild(img);
              article.appendChild(a_href);
              article.appendChild(h6);
              article.appendChild(document.createElement('br'))
              article.appendChild(ul);
              // article.appendChild(p);
              article.appendChild(footer);        

              one_third.appendChild(article);
              content.appendChild(one_third);
              count += 1;
            }
        })
        pastikanLogin()
    })
    .catch((error) => console.error(error));
 </script>
</body>
</html>
